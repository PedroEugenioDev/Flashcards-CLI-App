"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.stringWidth = void 0;
const emoji_regex_1 = __importDefault(require("emoji-regex"));
const ansi_1 = require("./lib/ansi");
const helpers_1 = require("./lib/helpers");
const stringWidth = (str) => {
    if (!str.length)
        return 0;
    str = str.replace(emoji_regex_1.default(), "  ");
    if (!str.length)
        return 0;
    str = ansi_1.stripAnsi(str);
    let width = 0;
    for (let i = 0; i < str.length; i++) {
        const code = str.codePointAt(i) || 0;
        // Ignore control characters
        if (code <= 0x1f || (code >= 0x7f && code <= 0x9f))
            continue;
        // Ignore combining characters
        if (code >= 0x300 && code <= 0x36f)
            continue;
        // Surrogates
        if (code > 0xffff)
            i++;
        width += helpers_1.isFullwidthCodePoint(code) ? 2 : 1;
    }
    return width;
};
exports.stringWidth = stringWidth;
exports.default = exports.stringWidth;
